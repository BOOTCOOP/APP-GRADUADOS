"use strict";(self["webpackChunkgraduados_app"]=self["webpackChunkgraduados_app"]||[]).push([[502],{1817:(e,a,l)=>{var o=l(2109),i=l(9781),t=l(7854),n=l(1702),r=l(2597),s=l(614),c=l(7976),u=l(1340),d=l(7045),v=l(9920),p=t.Symbol,m=p&&p.prototype;if(i&&s(p)&&(!("description"in m)||void 0!==p().description)){var f={},_=function(){var e=arguments.length<1||void 0===arguments[0]?void 0:u(arguments[0]),a=c(m,this)?new p(e):void 0===e?p():p(e);return""===e&&(f[a]=!0),a};v(_,p),_.prototype=m,m.constructor=_;var g="Symbol(test)"==String(p("test")),b=n(m.valueOf),h=n(m.toString),y=/^Symbol\((.*)\)[^)]+$/,w=n("".replace),k=n("".slice);d(m,"description",{configurable:!0,get:function(){var e=b(this);if(r(f,e))return"";var a=h(e),l=g?k(a,7,-1):w(a,y,"$1");return""===l?void 0:l}}),o({global:!0,constructor:!0,forced:!0},{Symbol:_})}},4502:(e,a,l)=>{l.r(a),l.d(a,{default:()=>H});l(4916),l(1817),l(7658);var o=l(6252),i=l(9963),t=l(3577),n=l(2262),r=l(7305),s=l(8903),c=l(2201),u=l(3907);const d={class:"ion-padding"},v={class:"form-group"},p={key:0,class:"error-message"},m={class:"form-group"},f={key:0,class:"error-message"},_={class:"form-group"},g={key:0,class:"error-message"},b={class:"form-group"},h={key:0,class:"error-message"},y={class:"file-upload-section"},w={class:"file-upload-container"},k={key:0,class:"upload-placeholder"},D={key:1,class:"file-preview"},S=["src"],q={key:1,class:"pdf-preview"},C={key:0,class:"error-message"},U={class:"form-footer"},E=["disabled"],z={key:0},A={key:1},P=(0,o.aZ)({__name:"CreateAviso",setup(e){const a=(0,c.tv)(),l=(0,u.oR)(),P=(0,n.iH)(null),F=(0,n.iH)({title:"",description:"",contact_phone:"",contact_email:""}),V=(0,n.iH)({title:"",description:"",contact_phone:"",contact_email:"",file:""}),H=(0,n.iH)(null),x=(0,n.iH)(null),M=(0,o.Fl)((()=>l.state.avisos.loading));function O(){var e;null===(e=P.value)||void 0===e||e.click()}function R(e){const a=e.target;if(!a.files||0===a.files.length)return;const l=a.files[0];if(H.value=l,l.size>5242880)return V.value.file="El archivo no debe superar los 5MB",void(H.value=null);if(!l.type.match("image.*")&&"application/pdf"!==l.type)return V.value.file="Solo se permiten imágenes y archivos PDF",void(H.value=null);if(V.value.file="",l.type.match("image.*")){const e=new FileReader;e.onload=e=>{var a;x.value=null===(a=e.target)||void 0===a?void 0:a.result},e.readAsDataURL(l)}else x.value="pdf"}function j(){H.value=null,x.value=null,P.value&&(P.value.value="")}function I(e){return!!e&&null!==e.type.match("image.*")}function T(){console.log("Valores del formulario:",F.value);let e=!0;return Object.keys(V.value).forEach((e=>{V.value[e]=""})),F.value.title.trim()?F.value.title.length>100&&(V.value.title="El título no debe exceder los 100 caracteres",e=!1):(V.value.title="El título es obligatorio",e=!1),F.value.description.trim()||(V.value.description="La descripción es obligatoria",e=!1),F.value.contact_phone.trim()||(V.value.contact_phone="El teléfono de contacto es obligatorio",e=!1),F.value.contact_email.trim()?/\S+@\S+\.\S+/.test(F.value.contact_email)||(V.value.contact_email="Ingrese un email válido",e=!1):(V.value.contact_email="El email de contacto es obligatorio",e=!1),console.log("Errores de validación:",V.value),e}async function W(){if(console.log("Submitting form..."),!T())return void console.log("Form validation failed");const e=new FormData;e.append("title",F.value.title),e.append("description",F.value.description),e.append("contact_phone",F.value.contact_phone),e.append("contact_email",F.value.contact_email),H.value&&e.append("file",H.value);try{console.log("Dispatching createAviso action...");const o=await l.dispatch("avisos/createAviso",e);if(console.log("Action result:",o),o){const e=await r.Mn.create({message:"Su aviso ha sido enviado y está pendiente de aprobación",duration:3e3,position:"bottom",color:"success"});await e.present(),a.push("/classifieds")}}catch(o){console.error("Error al crear aviso:",o);const e=await r.Cl.create({header:"Error",message:"Ocurrió un error al publicar su aviso. Por favor, inténtelo de nuevo.",buttons:["OK"]});await e.present()}}return(0,o.bv)((()=>{console.log("CreateAviso component mounted")})),(e,a)=>{const l=(0,o.up)("ion-icon"),r=(0,o.up)("graduados-app");return(0,o.wg)(),(0,o.j4)(r,{"header-title":"Publicar Aviso","header-show-back-button":!0},{default:(0,o.w5)((()=>{var e;return[(0,o._)("div",d,[(0,o._)("form",{onSubmit:(0,i.iM)(W,["prevent"]),class:"aviso-form full-height-container"},[a[11]||(a[11]=(0,o._)("div",{class:"form-header ion-margin-bottom"},[(0,o._)("h2",null,"Publicar un nuevo aviso"),(0,o._)("p",null," Complete los siguientes datos para publicar su aviso. Recuerde que debe ser aprobado por un administrador antes de ser visible para todos los usuarios. ")],-1)),(0,o._)("div",v,[a[4]||(a[4]=(0,o._)("label",{for:"title"},[(0,o.Uk)("Título "),(0,o._)("span",{class:"required"},"*")],-1)),(0,o.wy)((0,o._)("input",{id:"title","onUpdate:modelValue":a[0]||(a[0]=e=>F.value.title=e),type:"text",required:"",class:(0,t.C_)(["form-control",{"is-invalid":V.value.title}])},null,2),[[i.nr,F.value.title]]),V.value.title?((0,o.wg)(),(0,o.iD)("div",p,(0,t.zw)(V.value.title),1)):(0,o.kq)("",!0)]),(0,o._)("div",m,[a[5]||(a[5]=(0,o._)("label",{for:"description"},[(0,o.Uk)("Descripción "),(0,o._)("span",{class:"required"},"*")],-1)),(0,o.wy)((0,o._)("textarea",{id:"description","onUpdate:modelValue":a[1]||(a[1]=e=>F.value.description=e),rows:"4",required:"",class:(0,t.C_)(["form-control",{"is-invalid":V.value.description}])},null,2),[[i.nr,F.value.description]]),V.value.description?((0,o.wg)(),(0,o.iD)("div",f,(0,t.zw)(V.value.description),1)):(0,o.kq)("",!0)]),(0,o._)("div",_,[a[6]||(a[6]=(0,o._)("label",{for:"contact_phone"},[(0,o.Uk)("Teléfono de contacto "),(0,o._)("span",{class:"required"},"*")],-1)),(0,o.wy)((0,o._)("input",{id:"contact_phone","onUpdate:modelValue":a[2]||(a[2]=e=>F.value.contact_phone=e),type:"tel",required:"",class:(0,t.C_)(["form-control",{"is-invalid":V.value.contact_phone}])},null,2),[[i.nr,F.value.contact_phone]]),V.value.contact_phone?((0,o.wg)(),(0,o.iD)("div",g,(0,t.zw)(V.value.contact_phone),1)):(0,o.kq)("",!0)]),(0,o._)("div",b,[a[7]||(a[7]=(0,o._)("label",{for:"contact_email"},[(0,o.Uk)("Email de contacto "),(0,o._)("span",{class:"required"},"*")],-1)),(0,o.wy)((0,o._)("input",{id:"contact_email","onUpdate:modelValue":a[3]||(a[3]=e=>F.value.contact_email=e),type:"email",required:"",class:(0,t.C_)(["form-control",{"is-invalid":V.value.contact_email}])},null,2),[[i.nr,F.value.contact_email]]),V.value.contact_email?((0,o.wg)(),(0,o.iD)("div",h,(0,t.zw)(V.value.contact_email),1)):(0,o.kq)("",!0)]),(0,o._)("div",y,[a[9]||(a[9]=(0,o._)("div",{class:"file-upload-header"},[(0,o._)("h3",null,"Archivo adjunto (opcional)"),(0,o._)("p",null,"Suba una imagen o PDF con información adicional")],-1)),(0,o._)("div",w,[(0,o._)("div",{class:(0,t.C_)(["file-upload-box",{"has-file":x.value}]),onClick:O},[x.value?((0,o.wg)(),(0,o.iD)("div",D,[I(H.value)?((0,o.wg)(),(0,o.iD)("img",{key:0,src:x.value,alt:"Vista previa",class:"preview-image"},null,8,S)):((0,o.wg)(),(0,o.iD)("div",q,[(0,o.Wm)(l,{icon:(0,n.SU)(s.Pf6),size:"large"},null,8,["icon"]),(0,o._)("p",null,(0,t.zw)(null===(e=H.value)||void 0===e?void 0:e.name),1)]))])):((0,o.wg)(),(0,o.iD)("div",k,[(0,o.Wm)(l,{icon:(0,n.SU)(s.ok5),size:"large"},null,8,["icon"]),a[8]||(a[8]=(0,o._)("p",null,"Toque para seleccionar un archivo",-1))]))],2),(0,o._)("input",{type:"file",ref_key:"fileInput",ref:P,onChange:R,accept:"image/*,application/pdf",style:{display:"none"}},null,544),x.value?((0,o.wg)(),(0,o.iD)("button",{key:0,type:"button",class:"remove-file-btn",onClick:(0,i.iM)(j,["stop"])},[(0,o.Wm)(l,{icon:(0,n.SU)(s.gtu)},null,8,["icon"])])):(0,o.kq)("",!0)]),V.value.file?((0,o.wg)(),(0,o.iD)("div",C,(0,t.zw)(V.value.file),1)):(0,o.kq)("",!0)]),(0,o._)("div",U,[(0,o._)("button",{type:"button",class:"submit-button",disabled:M.value,onClick:W},[M.value?((0,o.wg)(),(0,o.iD)("span",z,a[10]||(a[10]=[(0,o._)("span",{class:"spinner"},null,-1),(0,o.Uk)(" Enviando... ")]))):((0,o.wg)(),(0,o.iD)("span",A,"Publicar Aviso"))],8,E)])],32)])]})),_:1})}}});var F=l(3744);const V=(0,F.Z)(P,[["__scopeId","data-v-c74d53ca"]]),H=V}}]);
//# sourceMappingURL=502-legacy.dc02051f.js.map